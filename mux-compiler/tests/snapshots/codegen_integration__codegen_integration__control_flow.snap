---
source: mux-compiler/tests/codegen_integration.rs
expression: ll_content
---
; ModuleID = 'mux_module'
source_filename = "mux_module"

@str_0 = global [9 x i8] c"Positive\00"
@str_1 = global [13 x i8] c"Non-positive\00"
@str_2 = global [8 x i8] c"Large: \00"
@str_3 = global [8 x i8] c"Small: \00"
@str_4 = global [5 x i8] c"None\00"
@str_5 = global [5 x i8] c"even\00"
@str_6 = global [4 x i8] c"odd\00"
@str_7 = global [9 x i8] c"Negative\00"
@str_8 = global [5 x i8] c"Zero\00"
@str_9 = global [9 x i8] c"Non-zero\00"
@str_10 = global [5 x i8] c"gt10\00"
@str_11 = global [4 x i8] c"gt5\00"
@str_12 = global [6 x i8] c"other\00"
@str_13 = global [4 x i8] c"one\00"
@str_14 = global [5 x i8] c"zero\00"
@str_15 = global [14 x i8] c"nl brace then\00"
@str_16 = global [14 x i8] c"nl brace else\00"
@str_17 = global [10 x i8] c"Final x: \00"

declare ptr @mux_value_from_string(ptr)

declare ptr @mux_new_string_from_cstr(ptr)

declare void @mux_print(ptr)

declare void @mux_println_val(ptr)

declare void @exit(i32)

declare ptr @malloc(i64)

declare ptr @mux_string_concat(ptr, ptr)

declare ptr @mux_value_get_string(ptr)

declare ptr @mux_value_from_string.1(ptr)

declare ptr @mux_int_to_string(i64)

declare ptr @mux_int_to_float(i64)

declare ptr @mux_float_to_int(double)

declare ptr @mux_float_to_string(double)

declare ptr @mux_bool_to_string(i32)

declare ptr @mux_bool_to_int(ptr)

declare ptr @mux_bool_to_float(ptr)

declare ptr @mux_string_to_string(ptr)

declare ptr @mux_list_to_string(ptr)

declare ptr @mux_map_to_string(ptr)

declare i32 @mux_register_object_type(ptr, i64)

declare ptr @mux_alloc_object(i32)

declare void @mux_free_object(ptr)

declare ptr @mux_get_object_ptr(ptr)

declare ptr @mux_set_to_string(ptr)

declare ptr @mux_optional_to_string(ptr)

declare ptr @mux_value_from_optional(ptr)

declare ptr @mux_value_get_list(ptr)

declare ptr @mux_value_get_map(ptr)

declare ptr @mux_value_to_string(ptr)

declare ptr @mux_list_value(ptr)

declare ptr @mux_map_value(ptr)

declare ptr @mux_set_value(ptr)

declare ptr @mux_range(i64, i64)

declare ptr @mux_new_list()

declare ptr @mux_new_map()

declare ptr @mux_new_set()

declare ptr @mux_value_add(ptr, ptr)

declare i64 @mux_value_get_int(ptr)

declare double @mux_value_get_float(ptr)

declare i32 @mux_value_get_bool(ptr)

declare i32 @mux_value_get_type_tag(ptr)

declare void @mux_free_value(ptr)

declare void @mux_list_push_back(ptr, ptr)

declare ptr @mux_list_get(ptr, i64)

declare ptr @mux_list_get_value(ptr, i64)

declare i64 @mux_list_length(ptr)

declare i64 @mux_value_list_length(ptr)

declare ptr @mux_value_list_get_value(ptr, i64)

declare ptr @mux_list_pop_back(ptr)

declare i1 @mux_list_is_empty(ptr)

declare void @mux_map_put(ptr, ptr, ptr)

declare ptr @mux_map_get(ptr, ptr)

declare i1 @mux_map_contains(ptr, ptr)

declare ptr @mux_map_remove(ptr, ptr)

declare void @mux_set_add(ptr, ptr)

declare i1 @mux_set_contains(ptr, ptr)

declare i1 @mux_set_remove(ptr, ptr)

declare i64 @mux_set_size(ptr)

declare i1 @mux_set_is_empty(ptr)

declare i64 @mux_map_size(ptr)

declare i1 @mux_map_is_empty(ptr)

declare ptr @mux_int_value(i64)

declare ptr @mux_float_value(double)

declare ptr @mux_bool_value(i32)

declare ptr @mux_string_value(ptr)

declare ptr @mux_int_to_string.2(i64)

declare i64 @mux_int_from_value(ptr)

declare double @mux_float_from_value(ptr)

declare i32 @mux_bool_from_value(ptr)

declare ptr @mux_string_from_value(ptr)

declare ptr @mux_result_ok_int(i64)

declare ptr @mux_result_err_str(ptr)

declare ptr @mux_optional_some_int(i64)

declare ptr @mux_optional_none()

declare ptr @mux_result_ok_int.3(i64)

declare ptr @mux_result_err_str.4(ptr)

declare i32 @mux_optional_discriminant(ptr)

declare ptr @mux_optional_data(ptr)

declare i32 @mux_result_discriminant(ptr)

declare ptr @mux_result_data(ptr)

define void @main() {
entry:
  %call = call ptr @mux_int_value(i64 5)
  %x = alloca ptr, align 8
  store ptr %call, ptr %x, align 8
  %x1 = load ptr, ptr %x, align 8
  %get_int = call i64 @mux_value_get_int(ptr %x1)
  %gt = icmp sgt i64 %get_int, 0
  br i1 %gt, label %if_then_0, label %if_else_0

if_then_0:                                        ; preds = %entry
  %call2 = call ptr @mux_new_string_from_cstr(ptr @str_0)
  call void @mux_println_val(ptr %call2)
  br label %if_merge_0

if_else_0:                                        ; preds = %entry
  %call3 = call ptr @mux_new_string_from_cstr(ptr @str_1)
  call void @mux_println_val(ptr %call3)
  br label %if_merge_0

if_merge_0:                                       ; preds = %if_else_0, %if_then_0
  %some_call = call ptr @mux_optional_some_int(i64 15)
  %discriminant_call = call i32 @mux_optional_discriminant(ptr %some_call)
  %match_cmp = icmp eq i32 %discriminant_call, 0
  br i1 %match_cmp, label %match_arm_1_0, label %match_next_1_0

match_end_1:                                      ; preds = %match_arm_1_2, %match_next_1_1, %match_arm_1_1, %match_guard_pass_0
  %index = alloca i64, align 8
  store i64 0, ptr %index, align 4
  %i = alloca ptr, align 8
  br label %for_header_2

match_arm_1_0:                                    ; preds = %if_merge_0
  %data_call = call ptr @mux_optional_data(ptr %some_call)
  %get_int4 = call i64 @mux_value_get_int(ptr %data_call)
  %call5 = call ptr @mux_int_value(i64 %get_int4)
  %v = alloca ptr, align 8
  store ptr %call5, ptr %v, align 8
  %v6 = load ptr, ptr %v, align 8
  %get_int7 = call i64 @mux_value_get_int(ptr %v6)
  %gt8 = icmp sgt i64 %get_int7, 10
  br i1 %gt8, label %match_guard_pass_0, label %match_next_1_0

match_next_1_0:                                   ; preds = %match_arm_1_0, %if_merge_0
  %match_cmp15 = icmp eq i32 %discriminant_call, 0
  br i1 %match_cmp15, label %match_arm_1_1, label %match_next_1_1

match_guard_pass_0:                               ; preds = %match_arm_1_0
  %call9 = call ptr @mux_new_string_from_cstr(ptr @str_2)
  %v10 = load ptr, ptr %v, align 8
  %get_int11 = call i64 @mux_value_get_int(ptr %v10)
  %int_to_str = call ptr @mux_int_to_string(i64 %get_int11)
  %new_str = call ptr @mux_new_string_from_cstr(ptr %int_to_str)
  %get_type = call i32 @mux_value_get_type_tag(ptr %call9)
  %is_string = icmp eq i32 %get_type, 3
  %get_type12 = call i32 @mux_value_get_type_tag(ptr %new_str)
  %is_string13 = icmp eq i32 %get_type12, 3
  %get_string = call ptr @mux_value_get_string(ptr %call9)
  %get_string14 = call ptr @mux_value_get_string(ptr %new_str)
  %string_concat = call ptr @mux_string_concat(ptr %get_string, ptr %get_string14)
  %from_string = call ptr @mux_value_from_string(ptr %string_concat)
  call void @mux_println_val(ptr %from_string)
  br label %match_end_1

match_arm_1_1:                                    ; preds = %match_next_1_0
  %data_call16 = call ptr @mux_optional_data(ptr %some_call)
  %get_int17 = call i64 @mux_value_get_int(ptr %data_call16)
  %call18 = call ptr @mux_int_value(i64 %get_int17)
  %v19 = alloca ptr, align 8
  store ptr %call18, ptr %v19, align 8
  %call20 = call ptr @mux_new_string_from_cstr(ptr @str_3)
  %v21 = load ptr, ptr %v19, align 8
  %get_int22 = call i64 @mux_value_get_int(ptr %v21)
  %int_to_str23 = call ptr @mux_int_to_string(i64 %get_int22)
  %new_str24 = call ptr @mux_new_string_from_cstr(ptr %int_to_str23)
  %get_type25 = call i32 @mux_value_get_type_tag(ptr %call20)
  %is_string26 = icmp eq i32 %get_type25, 3
  %get_type27 = call i32 @mux_value_get_type_tag(ptr %new_str24)
  %is_string28 = icmp eq i32 %get_type27, 3
  %get_string29 = call ptr @mux_value_get_string(ptr %call20)
  %get_string30 = call ptr @mux_value_get_string(ptr %new_str24)
  %string_concat31 = call ptr @mux_string_concat(ptr %get_string29, ptr %get_string30)
  %from_string32 = call ptr @mux_value_from_string(ptr %string_concat31)
  call void @mux_println_val(ptr %from_string32)
  br label %match_end_1

match_next_1_1:                                   ; preds = %match_next_1_0
  %match_cmp33 = icmp eq i32 %discriminant_call, 1
  br i1 %match_cmp33, label %match_arm_1_2, label %match_end_1

match_arm_1_2:                                    ; preds = %match_next_1_1
  %call34 = call ptr @mux_new_string_from_cstr(ptr @str_4)
  call void @mux_println_val(ptr %call34)
  br label %match_end_1

for_header_2:                                     ; preds = %for_body_2, %match_end_1
  %index_load = load i64, ptr %index, align 4
  %cmp = icmp slt i64 %index_load, 3
  br i1 %cmp, label %for_body_2, label %for_exit_2

for_body_2:                                       ; preds = %for_header_2
  %index_load2 = load i64, ptr %index, align 4
  %call35 = call ptr @mux_int_value(i64 %index_load2)
  store ptr %call35, ptr %i, align 8
  %i36 = load ptr, ptr %i, align 8
  %get_int37 = call i64 @mux_value_get_int(ptr %i36)
  %int_to_str38 = call ptr @mux_int_to_string(i64 %get_int37)
  %new_str39 = call ptr @mux_new_string_from_cstr(ptr %int_to_str38)
  call void @mux_println_val(ptr %new_str39)
  %inc = add i64 %index_load2, 1
  store i64 %inc, ptr %index, align 4
  br label %for_header_2

for_exit_2:                                       ; preds = %for_header_2
  %index40 = alloca i64, align 8
  store i64 0, ptr %index40, align 4
  %j = alloca ptr, align 8
  br label %for_header_3

for_header_3:                                     ; preds = %if_merge_4, %for_exit_2
  %index_load41 = load i64, ptr %index40, align 4
  %cmp42 = icmp slt i64 %index_load41, 10
  br i1 %cmp42, label %for_body_3, label %for_exit_3

for_body_3:                                       ; preds = %for_header_3
  %index_load243 = load i64, ptr %index40, align 4
  %call44 = call ptr @mux_int_value(i64 %index_load243)
  store ptr %call44, ptr %j, align 8
  %j45 = load ptr, ptr %j, align 8
  %get_int46 = call i64 @mux_value_get_int(ptr %j45)
  %mod = srem i64 %get_int46, 2
  %eq = icmp eq i64 %mod, 0
  br i1 %eq, label %if_then_4, label %if_else_4

for_exit_3:                                       ; preds = %for_header_3
  br label %while_header

if_then_4:                                        ; preds = %for_body_3
  %call47 = call ptr @mux_new_string_from_cstr(ptr @str_5)
  call void @mux_println_val(ptr %call47)
  br label %if_merge_4

if_else_4:                                        ; preds = %for_body_3
  %call48 = call ptr @mux_new_string_from_cstr(ptr @str_6)
  call void @mux_println_val(ptr %call48)
  br label %if_merge_4

if_merge_4:                                       ; preds = %if_else_4, %if_then_4
  %inc49 = add i64 %index_load243, 1
  store i64 %inc49, ptr %index40, align 4
  br label %for_header_3

while_header:                                     ; preds = %while_body, %for_exit_3
  %x50 = load ptr, ptr %x, align 8
  %get_int51 = call i64 @mux_value_get_int(ptr %x50)
  %gt52 = icmp sgt i64 %get_int51, 0
  br i1 %gt52, label %while_body, label %while_exit

while_body:                                       ; preds = %while_header
  %x53 = load ptr, ptr %x, align 8
  %get_int54 = call i64 @mux_value_get_int(ptr %x53)
  %sub_assign = sub i64 %get_int54, 1
  %call55 = call ptr @mux_int_value(i64 %sub_assign)
  store ptr %call55, ptr %x, align 8
  br label %while_header

while_exit:                                       ; preds = %while_header
  %x56 = load ptr, ptr %x, align 8
  %get_int57 = call i64 @mux_value_get_int(ptr %x56)
  %lt = icmp slt i64 %get_int57, 0
  br i1 %lt, label %if_then_5, label %if_else_5

if_then_5:                                        ; preds = %while_exit
  %call58 = call ptr @mux_new_string_from_cstr(ptr @str_7)
  call void @mux_println_val(ptr %call58)
  br label %if_merge_5

if_else_5:                                        ; preds = %while_exit
  br label %if_merge_5

if_merge_5:                                       ; preds = %if_else_5, %if_then_5
  %x59 = load ptr, ptr %x, align 8
  %get_int60 = call i64 @mux_value_get_int(ptr %x59)
  %eq61 = icmp eq i64 %get_int60, 0
  br i1 %eq61, label %if_then_6, label %if_else_6

if_then_6:                                        ; preds = %if_merge_5
  %call62 = call ptr @mux_new_string_from_cstr(ptr @str_8)
  call void @mux_println_val(ptr %call62)
  br label %if_merge_6

if_else_6:                                        ; preds = %if_merge_5
  %call63 = call ptr @mux_new_string_from_cstr(ptr @str_9)
  call void @mux_println_val(ptr %call63)
  br label %if_merge_6

if_merge_6:                                       ; preds = %if_else_6, %if_then_6
  %x64 = load ptr, ptr %x, align 8
  %get_int65 = call i64 @mux_value_get_int(ptr %x64)
  %gt66 = icmp sgt i64 %get_int65, 10
  br i1 %gt66, label %if_then_7, label %if_else_7

if_then_7:                                        ; preds = %if_merge_6
  %call67 = call ptr @mux_new_string_from_cstr(ptr @str_10)
  call void @mux_println_val(ptr %call67)
  br label %if_merge_7

if_else_7:                                        ; preds = %if_merge_6
  %x68 = load ptr, ptr %x, align 8
  %get_int69 = call i64 @mux_value_get_int(ptr %x68)
  %gt70 = icmp sgt i64 %get_int69, 5
  br i1 %gt70, label %if_then_8, label %if_else_8

if_merge_7:                                       ; preds = %if_merge_8, %if_then_7
  %index73 = alloca i64, align 8
  store i64 0, ptr %index73, align 4
  %j74 = alloca ptr, align 8
  br label %for_header_9

if_then_8:                                        ; preds = %if_else_7
  %call71 = call ptr @mux_new_string_from_cstr(ptr @str_11)
  call void @mux_println_val(ptr %call71)
  br label %if_merge_8

if_else_8:                                        ; preds = %if_else_7
  %call72 = call ptr @mux_new_string_from_cstr(ptr @str_12)
  call void @mux_println_val(ptr %call72)
  br label %if_merge_8

if_merge_8:                                       ; preds = %if_else_8, %if_then_8
  br label %if_merge_7

for_header_9:                                     ; preds = %if_merge_10, %if_merge_7
  %index_load75 = load i64, ptr %index73, align 4
  %cmp76 = icmp slt i64 %index_load75, 3
  br i1 %cmp76, label %for_body_9, label %for_exit_9

for_body_9:                                       ; preds = %for_header_9
  %index_load277 = load i64, ptr %index73, align 4
  %call78 = call ptr @mux_int_value(i64 %index_load277)
  store ptr %call78, ptr %j74, align 8
  %j79 = load ptr, ptr %j74, align 8
  %get_int80 = call i64 @mux_value_get_int(ptr %j79)
  %eq81 = icmp eq i64 %get_int80, 1
  br i1 %eq81, label %if_then_10, label %if_else_10

for_exit_9:                                       ; preds = %for_header_9
  br label %while_header88

if_then_10:                                       ; preds = %for_body_9
  %call82 = call ptr @mux_new_string_from_cstr(ptr @str_13)
  call void @mux_println_val(ptr %call82)
  br label %if_merge_10

if_else_10:                                       ; preds = %for_body_9
  %j83 = load ptr, ptr %j74, align 8
  %get_int84 = call i64 @mux_value_get_int(ptr %j83)
  %eq85 = icmp eq i64 %get_int84, 0
  br i1 %eq85, label %if_then_11, label %if_else_11

if_merge_10:                                      ; preds = %if_merge_11, %if_then_10
  %inc87 = add i64 %index_load277, 1
  store i64 %inc87, ptr %index73, align 4
  br label %for_header_9

if_then_11:                                       ; preds = %if_else_10
  %call86 = call ptr @mux_new_string_from_cstr(ptr @str_14)
  call void @mux_println_val(ptr %call86)
  br label %if_merge_11

if_else_11:                                       ; preds = %if_else_10
  br label %if_merge_11

if_merge_11:                                      ; preds = %if_else_11, %if_then_11
  br label %if_merge_10

while_header88:                                   ; preds = %while_body89, %for_exit_9
  %x91 = load ptr, ptr %x, align 8
  %get_int92 = call i64 @mux_value_get_int(ptr %x91)
  %lt93 = icmp slt i64 %get_int92, 3
  br i1 %lt93, label %while_body89, label %while_exit90

while_body89:                                     ; preds = %while_header88
  %x94 = load ptr, ptr %x, align 8
  %get_int95 = call i64 @mux_value_get_int(ptr %x94)
  %add = add i64 %get_int95, 1
  %call96 = call ptr @mux_int_value(i64 %add)
  store ptr %call96, ptr %x, align 8
  br label %while_header88

while_exit90:                                     ; preds = %while_header88
  %x97 = load ptr, ptr %x, align 8
  %get_int98 = call i64 @mux_value_get_int(ptr %x97)
  %gt99 = icmp sgt i64 %get_int98, 1
  br i1 %gt99, label %if_then_12, label %if_else_12

if_then_12:                                       ; preds = %while_exit90
  %call100 = call ptr @mux_new_string_from_cstr(ptr @str_15)
  call void @mux_println_val(ptr %call100)
  br label %if_merge_12

if_else_12:                                       ; preds = %while_exit90
  %call101 = call ptr @mux_new_string_from_cstr(ptr @str_16)
  call void @mux_println_val(ptr %call101)
  br label %if_merge_12

if_merge_12:                                      ; preds = %if_else_12, %if_then_12
  %call102 = call ptr @mux_new_string_from_cstr(ptr @str_17)
  %x103 = load ptr, ptr %x, align 8
  %get_int104 = call i64 @mux_value_get_int(ptr %x103)
  %int_to_str105 = call ptr @mux_int_to_string(i64 %get_int104)
  %new_str106 = call ptr @mux_new_string_from_cstr(ptr %int_to_str105)
  %get_type107 = call i32 @mux_value_get_type_tag(ptr %call102)
  %is_string108 = icmp eq i32 %get_type107, 3
  %get_type109 = call i32 @mux_value_get_type_tag(ptr %new_str106)
  %is_string110 = icmp eq i32 %get_type109, 3
  %get_string111 = call ptr @mux_value_get_string(ptr %call102)
  %get_string112 = call ptr @mux_value_get_string(ptr %new_str106)
  %string_concat113 = call ptr @mux_string_concat(ptr %get_string111, ptr %get_string112)
  %from_string114 = call ptr @mux_value_from_string(ptr %string_concat113)
  call void @mux_println_val(ptr %from_string114)
  ret void
}
