// Comprehensive optional & result Type Extraction Tests

print("=== Testing result<int, string> ===")

// Test 1: result<int, string> with ok
func divide(int a, int b) returns result<int, string> {
    if b == 0 { return err("Division by zero") }
    return ok(a / b)
}

auto res1 = divide(10, 2)
match res1 {
    ok(v) { print("✓ result<int, string> ok: " + v.to_string()) }
    err(e) { print("✗ Unexpected error: " + e) }
}

// Test 2: result<int, string> with err
auto res2 = divide(10, 0)
match res2 {
    ok(v) { print("✗ Unexpected success: " + v.to_string()) }
    err(e) { print("✓ result<int, string> err: " + e) }
}

print("")
print("=== Testing optional<int> ===")

// Test 3: optional<int> with some
func findEven(list<int> nums) returns optional<int> {
    for int n in nums { if n % 2 == 0 { return some(n) } }
    return none
}

auto opt1 = findEven([1, 3, 4, 7])
match opt1 {
    some(n) { print("✓ optional<int> some: " + n.to_string()) }
    none { print("✗ Unexpected none") }
}

// Test 4: optional<int> with none
auto opt2 = findEven([1, 3, 5, 7])
match opt2 {
    some(n) { print("✗ Unexpected some: " + n.to_string()) }
    none { print("✓ optional<int> none") }
}

print("")
print("=== Testing result<string, string> ===")

// Test 5: result<string, string> with ok
func validateInput(int code) returns result<string, string> {
    if code == 0 { return err("Empty input") }
    return ok("Valid input")
}

auto res3 = validateInput(1)
match res3 {
    ok(msg) { print("✓ result<string, string> ok: " + msg) }
    err(e) { print("✗ Unexpected error: " + e) }
}

// Test 6: result<string, string> with err  
auto res4 = validateInput(0)
match res4 {
    ok(msg) { print("✗ Unexpected success: " + msg) }
    err(e) { print("✓ result<string, string> err: " + e) }
}

print("")
print("=== Testing optional<list<int>> ===")

// Test 7: optional<list<int>> with some
func getNumbersIfPositive(int threshold) returns optional<list<int>> {
    if threshold <= 0 { return none }
    return some([1, 2, 3])
}

auto opt3 = getNumbersIfPositive(5)
match opt3 {
    some(lst) { print("✓ optional<list<int>> some: list returned") }
    none { print("✗ Unexpected none") }
}

print("")
print("=== Testing result<list<string>, string> ===")

// Test 8: result<list<string>, string> with ok
func getNames(int code) returns result<list<string>, string> {
    if code == 0 { return err("Invalid request") }
    return ok(["Alice", "Bob", "Charlie"])
}

auto res5 = getNames(1)
match res5 {
    ok(names) { print("✓ result<list<string>, string> ok: list returned") }
    err(e) { print("✗ Unexpected error: " + e) }
}

print("")
print("=== All tests completed ===")
