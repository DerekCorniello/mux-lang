// Comprehensive Optional & Result Type Extraction Tests

println("=== Testing Result<int, string> ===")

// Test 1: Result<int, string> with Ok
func divide(int a, int b) returns Result<int, string> {
    if b == 0 { return Err("Division by zero") }
    return Ok(a / b)
}

auto res1 = divide(10, 2)
match res1 {
    Ok(v) { println("✓ Result<int, string> Ok: " + v.to_string()) }
    Err(e) { println("✗ Unexpected error: " + e) }
}

// Test 2: Result<int, string> with Err
auto res2 = divide(10, 0)
match res2 {
    Ok(v) { println("✗ Unexpected success: " + v.to_string()) }
    Err(e) { println("✓ Result<int, string> Err: " + e) }
}

println("")
println("=== Testing Optional<int> ===")

// Test 3: Optional<int> with Some
func findEven(list<int> nums) returns Optional<int> {
    for int n in nums { if n % 2 == 0 { return Some(n) } }
    return None
}

auto opt1 = findEven([1, 3, 4, 7])
match opt1 {
    Some(n) { println("✓ Optional<int> Some: " + n.to_string()) }
    None { println("✗ Unexpected None") }
}

// Test 4: Optional<int> with None
auto opt2 = findEven([1, 3, 5, 7])
match opt2 {
    Some(n) { println("✗ Unexpected Some: " + n.to_string()) }
    None { println("✓ Optional<int> None") }
}

println("")
println("=== Testing Result<string, string> ===")

// Test 5: Result<string, string> with Ok
func validateInput(int code) returns Result<string, string> {
    if code == 0 { return Err("Empty input") }
    return Ok("Valid input")
}

auto res3 = validateInput(1)
match res3 {
    Ok(msg) { println("✓ Result<string, string> Ok: " + msg) }
    Err(e) { println("✗ Unexpected error: " + e) }
}

// Test 6: Result<string, string> with Err  
auto res4 = validateInput(0)
match res4 {
    Ok(msg) { println("✗ Unexpected success: " + msg) }
    Err(e) { println("✓ Result<string, string> Err: " + e) }
}

println("")
println("=== Testing Optional<list<int>> ===")

// Test 7: Optional<list<int>> with Some
func getNumbersIfPositive(int threshold) returns Optional<list<int>> {
    if threshold <= 0 { return None }
    return Some([1, 2, 3])
}

auto opt3 = getNumbersIfPositive(5)
match opt3 {
    Some(lst) { println("✓ Optional<list<int>> Some: list returned") }
    None { println("✗ Unexpected None") }
}

println("")
println("=== Testing Result<list<string>, string> ===")

// Test 8: Result<list<string>, string> with Ok
func getNames(int code) returns Result<list<string>, string> {
    if code == 0 { return Err("Invalid request") }
    return Ok(["Alice", "Bob", "Charlie"])
}

auto res5 = getNames(1)
match res5 {
    Ok(names) { println("✓ Result<list<string>, string> Ok: list returned") }
    Err(e) { println("✗ Unexpected error: " + e) }
}

println("")
println("=== All tests completed ===")
