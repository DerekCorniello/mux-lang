import std.datetime

const int EPOCH_TS = 0

match datetime.year(EPOCH_TS) {
    ok(v) {
        if v == 1970 {
            print("PASS: year")
        } else {
            print("FAIL: year")
        }
    }
    err(_) { print("FAIL: year") }
}

match datetime.month(EPOCH_TS) {
    ok(v) {
        if v == 1 {
            print("PASS: month")
        } else {
            print("FAIL: month")
        }
    }
    err(_) { print("FAIL: month") }
}

match datetime.day(EPOCH_TS) {
    ok(v) {
        if v == 1 {
            print("PASS: day")
        } else {
            print("FAIL: day")
        }
    }
    err(_) { print("FAIL: day") }
}

match datetime.hour(EPOCH_TS) {
    ok(v) {
        if v == 0 {
            print("PASS: hour")
        } else {
            print("FAIL: hour")
        }
    }
    err(_) { print("FAIL: hour") }
}

match datetime.minute(EPOCH_TS) {
    ok(v) {
        if v == 0 {
            print("PASS: minute")
        } else {
            print("FAIL: minute")
        }
    }
    err(_) { print("FAIL: minute") }
}

match datetime.second(EPOCH_TS) {
    ok(v) {
        if v == 0 {
            print("PASS: second")
        } else {
            print("FAIL: second")
        }
    }
    err(_) { print("FAIL: second") }
}

match datetime.weekday(EPOCH_TS) {
    ok(v) {
        if v == 4 {
            print("PASS: weekday")
        } else {
            print("FAIL: weekday")
        }
    }
    err(_) { print("FAIL: weekday") }
}

match datetime.format(EPOCH_TS, "%A, %B %d, %Y %H:%M:%S UTC") {
    ok(v) {
        if v == "Thursday, January 01, 1970 00:00:00 UTC" {
            print("PASS: format utc")
        } else {
            print("FAIL: format utc")
        }
    }
    err(_) { print("FAIL: format utc") }
}

match datetime.format_local(EPOCH_TS, "%Y-%m-%d %H:%M:%S %Z") {
    ok(_) { print("PASS: format local") }
    err(_) { print("FAIL: format local") }
}

match datetime.now() {
    ok(_) { print("PASS: now") }
    err(_) { print("FAIL: now") }
}

match datetime.now_millis() {
    ok(_) { print("PASS: now_millis") }
    err(_) { print("FAIL: now_millis") }
}

print("Sleep order marker: before")
match datetime.sleep_millis(5) {
    ok(_) { print("PASS: sleep_millis") }
    err(_) { print("FAIL: sleep_millis") }
}
print("Sleep order marker: after")

match datetime.format(-9999999999999, "%A") {
    ok(_) { print("FAIL: invalid format timestamp") }
    err(_) { print("PASS: invalid format timestamp") }
}

match datetime.format_local(-9999999999999, "%B") {
    ok(_) { print("FAIL: invalid local format timestamp") }
    err(_) { print("PASS: invalid local format timestamp") }
}

match datetime.year(-9999999999999) {
    ok(_) { print("FAIL: invalid year timestamp") }
    err(_) { print("PASS: invalid year timestamp") }
}

print("All datetime tests passed!")
